(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68698,e=>{"use strict";var t=e.i(39057),a=e.i(48277),s=e.i(30668),r=e.i(6305),l=e.i(35884);let o=(0,l.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);var n=e.i(99507),i=e.i(30704),c=e.i(80380);let d=(0,l.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var x=e.i(67494);let m=(0,l.default)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),h=(0,l.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var u=e.i(82087),g=e.i(97599),p=e.i(66463),b=e.i(87635),f=e.i(216),y=e.i(42350),w=e.i(3333),j=e.i(54133);let N=(0,l.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var v=e.i(32425),k=e.i(49449),C=e.i(29150);let S=(0,l.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function P({message:e,type:t,onClose:r}){return(0,s.useEffect)(()=>{let e=setTimeout(r,3e3);return()=>clearTimeout(e)},[r]),(0,a.jsxs)("div",{className:`fixed top-4 right-4 z-[100] flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg transform transition-all animate-in slide-in-from-right-5 fade-in duration-300 ${"success"===t?"bg-green-50 text-green-800 border border-green-100":"bg-red-50 text-red-800 border border-red-100"}`,children:["success"===t?(0,a.jsx)(f.Check,{className:"w-5 h-5 text-green-600"}):(0,a.jsx)(y.AlertCircle,{className:"w-5 h-5 text-red-600"}),(0,a.jsx)("span",{className:"font-medium text-sm",children:e}),(0,a.jsx)("button",{onClick:r,className:"p-1 hover:bg-black/5 rounded-full transition-colors",children:(0,a.jsx)(b.X,{className:"w-4 h-4 opacity-50"})})]})}function A({isOpen:e,onClose:t}){let[r,l]=(0,s.useState)([]),[o,n]=(0,s.useState)(!0);(0,s.useEffect)(()=>{e&&d()},[e]);let d=async()=>{n(!0);try{let e=await fetch("/api/settings/audit-logs",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){let t=await e.json();l(t.logs||[])}}catch(e){console.error(e)}finally{n(!1)}};return e?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl p-6 h-[600px] flex flex-col transform transition-all animate-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6 border-b border-gray-100 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-slate-100 rounded-lg",children:(0,a.jsx)(i.Shield,{className:"w-5 h-5 text-slate-700"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"System Audit Logs"})]}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(b.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2",children:o?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)(c.Loader2,{className:"w-8 h-8 animate-spin text-gray-300"})}):0===r.length?(0,a.jsx)("p",{className:"text-center text-gray-400 py-10",children:"No activity recorded yet."}):r.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 rounded-xl hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-sm text-slate-800",children:e.action}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:e.details||"No details"}),(0,a.jsx)("p",{className:"text-[10px] text-slate-400 mt-1 font-mono uppercase",children:e.id})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-slate-500 bg-slate-100 px-2 py-1 rounded-md",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("p",{className:"text-[10px] text-slate-400 mt-1",children:new Date(e.createdAt).toLocaleTimeString()})]})]},e.id))})]})}):null}function T({name:e,description:t,connectedKey:s,integrations:r,onConnectClick:l,onDisconnectClick:o,loading:n,icon:i}){let d=r&&r[s]||{},x=!!d&&(!0===d||!0===d.connected),m=n===s;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl transition-all hover:border-gray-300 bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:`p-3 rounded-xl ${x?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:i?(0,a.jsx)(i,{className:"w-6 h-6"}):(0,a.jsx)("div",{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-gray-900",children:e}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:t})]})]}),(0,a.jsx)("button",{onClick:()=>x?o(s):l(s),disabled:m,className:`flex items-center px-4 py-2 rounded-lg text-xs font-bold transition-all duration-200 min-w-[100px] justify-center
                    ${x?"bg-red-50 text-red-600 hover:bg-red-100":"bg-black text-white hover:bg-gray-800 shadow-md hover:shadow-lg"} ${m?"opacity-80 cursor-wait":""}`,children:m?(0,a.jsx)(c.Loader2,{className:"w-3 h-3 animate-spin mr-1"}):x?(0,a.jsx)(a.Fragment,{children:"Disconnect"}):(0,a.jsx)(a.Fragment,{children:"Connect"})})]})}function U({isOpen:e,onClose:t,onSave:s}){return e?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-md p-6 transform transition-all animate-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Create Workflow"}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(b.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target);s({name:t.get("name"),trigger:t.get("trigger"),action:t.get("action")})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Workflow Name"}),(0,a.jsx)("input",{name:"name",type:"text",required:!0,placeholder:"e.g. New Client Welcome",className:"w-full p-3 bg-gray-50 border-none rounded-xl text-sm font-medium focus:ring-2 focus:ring-black/5 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Trigger Event"}),(0,a.jsxs)("select",{name:"trigger",className:"w-full p-3 bg-gray-50 border-none rounded-xl text-sm font-medium focus:ring-2 focus:ring-black/5 outline-none",children:[(0,a.jsx)("option",{value:"new_client",children:"New Lead Captured"}),(0,a.jsx)("option",{value:"booking_confirmed",children:"Booking Scheduled"}),(0,a.jsx)("option",{value:"payment_failed",children:"Payment Failed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Action"}),(0,a.jsxs)("select",{name:"action",className:"w-full p-3 bg-gray-50 border-none rounded-xl text-sm font-medium focus:ring-2 focus:ring-black/5 outline-none",children:[(0,a.jsx)("option",{value:"send_email",children:"Send Email"}),(0,a.jsx)("option",{value:"send_sms",children:"Send SMS"}),(0,a.jsx)("option",{value:"notify_team",children:"Notify Team (Slack)"})]})]}),(0,a.jsxs)("div",{className:"mt-8 flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-5 py-2.5 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-xl transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-5 py-2.5 text-sm font-bold text-white bg-black hover:bg-gray-800 rounded-xl transition-all shadow-lg hover:shadow-xl",children:"Save Workflow"})]})]})]})}):null}function B({plan:e,showToast:t}){let s=async()=>{try{let e=await fetch("/api/payments/portal",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){let{url:t}=await e.json();window.location.href=t}else t("Failed to initiate billing portal.","error")}catch(e){console.error(e),t("Network error.","error")}};return(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-sm border border-gray-100 p-8 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6 border-b border-gray-100 pb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,a.jsx)(N,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"Subscription & Billing"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Manage your plan and payment methods."})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 bg-slate-50 border border-slate-200 rounded-2xl",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Current Plan"}),(0,a.jsx)("h3",{className:"text-2xl font-extrabold text-slate-900",children:e}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Next billing date: Jan 1, 2026"})]}),(0,a.jsxs)("button",{onClick:s,className:"flex items-center gap-2 px-6 py-3 bg-white border border-slate-300 shadow-sm text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-slate-400 transition-all",children:["Manage Subscription ",(0,a.jsx)(S,{className:"w-4 h-4"})]})]})]})}function z({showToast:e}){let[r,l]=(0,s.useState)(!0),[o,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[x,m]=(0,s.useState)(!1),[h,u]=(0,s.useState)(""),[p,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{f();let e=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:5000";d(`${e}/api/twilio/webhook/voice`)},[]);let f=async()=>{l(!0);let a=localStorage.getItem("token"),s=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:5000";try{let e=await fetch(`${s}/api/organization/info`,{headers:{Authorization:`Bearer ${a}`}});if(e.ok){let t=await e.json();t.organization?.twilioConfig?.phoneNumber&&n(t.organization.twilioConfig.phoneNumber)}}catch(t){console.error("Failed to fetch voice data:",t),e("Failed to load voice configuration.","error")}finally{l(!1)}},y=async()=>{if(!o)return e("Please enter a phone number.","error");m(!0);let a=localStorage.getItem("token"),s=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:5000";try{(await fetch(`${s}/api/organization/info`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({twilioConfig:{phoneNumber:o}})})).ok?e("Inbound number saved successfully!","success"):e("Failed to save configuration.","error")}catch(t){e("Network error while saving.","error")}finally{m(!1)}},w=async()=>{if(!h)return e("Please enter a phone number.","error");b(!0);let a=localStorage.getItem("token"),s=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:5000";try{let t=await fetch(`${s}/api/voice/outbound`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({phoneNumber:h})}),r=await t.json();t.ok?e("Test call initiated!","success"):e(r.error||"Failed to start call.","error")}catch(t){e("Call failed.","error")}finally{b(!1)}};return r?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(c.Loader2,{className:"animate-spin text-gray-400"})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:`p-4 rounded-xl border ${o?"bg-green-50 border-green-100":"bg-gray-50 border-gray-200"} transition-all`,children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:`p-2 rounded-lg ${o?"bg-green-100 text-green-600":"bg-gray-200 text-gray-500"}`,children:(0,a.jsx)(g.Phone,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-900",children:o?"Voice System Active":"Setup Required"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:o?`Calls authorized for: ${o}`:"Connect a Twilio number to start."})]})]}),o&&(0,a.jsx)("span",{className:"text-xs font-bold text-green-600 bg-green-100 px-3 py-1 rounded-full uppercase tracking-wider",children:"Online"})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider",children:"Inbound Configuration"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500",children:"Your Twilio Phone Number"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:o,onChange:e=>n(e.target.value),placeholder:"+1 234 567 8900",className:"flex-1 px-4 py-3 bg-white border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-100 font-medium"}),(0,a.jsx)("button",{onClick:y,disabled:x,className:"px-6 py-2 bg-black text-white font-bold text-sm rounded-xl hover:bg-gray-800 disabled:opacity-50 transition-all",children:x?(0,a.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):"Save"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Enter the number you purchased in Twilio."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500",children:"Twilio Webhook URL"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{readOnly:!0,value:i,className:"flex-1 px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-500 font-mono text-xs"}),(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(i),e("Copied to clipboard!","success")},className:"px-4 py-2 bg-gray-100 text-gray-600 font-bold text-sm rounded-xl hover:bg-gray-200 transition-all border border-gray-200",children:(0,a.jsx)(S,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:'Paste this URL into the "Voice & Fax" Webhook field in your Twilio Console.'})]})]}),(0,a.jsxs)("div",{className:"pt-6 border-t border-gray-100",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider mb-4",children:"Connection Verification"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("input",{type:"tel",placeholder:"Enter your cell phone number...",value:h,onChange:e=>u(e.target.value),className:"flex-1 px-4 py-2 bg-white border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-100 text-sm font-medium"}),(0,a.jsxs)("button",{onClick:w,disabled:p||!h,className:"px-5 py-2 bg-green-600 text-white font-bold text-sm rounded-xl hover:bg-green-700 disabled:opacity-50 transition-all flex items-center gap-2 shadow-sm shadow-green-100",children:[p?(0,a.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(g.Phone,{className:"w-4 h-4"}),"Call Me"]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"We will call this number to verify your AI agent is active."})]})]})}function I(){let[e,l]=(0,s.useState)(!0),[b,f]=(0,s.useState)(!1),[y,S]=(0,s.useState)(null),I=(e,t)=>{S({message:e,type:t})},[$,L]=(0,s.useState)(!1),[F,M]=(0,s.useState)(!1),[O,_]=(0,s.useState)({isOpen:!1,type:null}),[E,D]=(0,s.useState)(null),[W,J]=(0,s.useState)({}),[R,V]=(0,s.useState)([]),[X,q]=(0,s.useState)({brandColor:"#000000",aiName:"",logoUrl:"",customSystemPrompt:"",plan:"Basic"}),[K,H]=(0,s.useState)({name:"",email:"",phoneNumber:"",avatarUrl:""}),[G,Y]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),Z=(0,s.useRef)(null),[Q,ee]=(0,s.useState)(!1);(0,s.useEffect)(()=>{et(),ea()},[]);let et=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/settings",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=(await t.json()).user||{};if(q({brandColor:e.tenant?.brandColor||"#000000",aiName:e.tenant?.aiName||"",logoUrl:e.tenant?.logoUrl||"",customSystemPrompt:e.tenant?.customSystemPrompt||"",plan:e.tenant?.plan||"Basic"}),e.tenant?.integrations)try{J(JSON.parse(e.tenant.integrations)||{})}catch(e){J({})}H({name:e.name||"",email:e.email,phoneNumber:e.phoneNumber||"",avatarUrl:e.avatarUrl||""})}}catch(e){console.error("Failed to fetch settings:",e),I("Failed to load settings.","error")}finally{l(!1)}},ea=async()=>{try{let e=await fetch("/api/workflows",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=await e.json();console.log("Workflows fetched:",t),e.ok?V(t.workflows||[]):console.error("Failed to fetch workflows:",t)}catch(e){console.error("Failed to fetch workflows",e)}},es=async()=>{let e,t,a;if(e=K.email,!/\S+@\S+\.\S+/.test(e))return I("Please enter a valid email address.","error");if(!(!(t=K.phoneNumber)||/^\+?[0-9\s-()]+$/.test(t)))return I("Please enter a valid phone number.","error");if(X.logoUrl&&!(!(a=X.logoUrl)||/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(a)))return I("Please enter a valid Logo URL.","error");f(!0);let s=localStorage.getItem("token");try{await fetch("/api/settings/tenant",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(X)}),await fetch("/api/settings/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({name:K.name,email:K.email,phoneNumber:K.phoneNumber})}),I("Settings saved successfully!","success")}catch(e){console.error(e),I("Failed to save settings.","error")}finally{f(!1)}},er=async()=>{if(G.newPassword!==G.confirmPassword)return I("New passwords do not match.","error");if(G.newPassword.length<6)return I("Password must be at least 6 characters.","error");f(!0);let e=localStorage.getItem("token");try{let t=await fetch("/api/settings/password",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({currentPassword:G.currentPassword,newPassword:G.newPassword})});if(t.ok)I("Password changed successfully.","success"),Y({currentPassword:"",newPassword:"",confirmPassword:""});else{let e=await t.json();I(e.error||"Failed to change password.","error")}}catch(e){console.error(e),I("An unexpected error occurred.","error")}finally{f(!1)}},el=async e=>{L(!1);try{(await fetch("/api/workflows",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)})).ok?(I("Workflow created successfully!","success"),ea()):I("Failed to create workflow.","error")}catch(e){I("Network error.","error")}},eo=async e=>{if(confirm("Delete this workflow?"))try{(await fetch(`/api/workflows/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok&&(I("Workflow deleted.","success"),ea())}catch(e){I("Failed to delete.","error")}},en=async e=>{let t=e.target.files?.[0];if(!t)return;ee(!0);let a=new FormData;a.append("avatar",t);let s=localStorage.getItem("token");try{let e=await fetch("/api/upload/avatar",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:a});if(e.ok){let t=await e.json();H(e=>({...e,avatarUrl:t.avatarUrl})),I("Profile picture updated!","success")}}catch(e){console.error("Avatar upload failed:",e),I("Failed to upload image.","error")}finally{ee(!1)}},ei=e=>{if("Advanced"!==X.plan&&"Trial"!==X.plan&&"Basic"!==X.plan)return I("Upgrade to Advanced to use integrations.","error");ec(e,{})},ec=async(e,t)=>{_(e=>({...e,isOpen:!1}));let a=localStorage.getItem("token");D(e),await new Promise(e=>setTimeout(e,1500));let s={...W,[e]:{connected:!0,connectedAt:new Date().toISOString(),...t}};try{(await fetch("/api/settings/integrations",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({integrations:JSON.stringify(s)})})).ok?(J(s),I(`${e} connected successfully!`,"success")):I("Failed to update integration status.","error")}catch(e){console.error(e),I("Network error.","error")}finally{D(null),_({isOpen:!1,type:null})}},ed=async e=>{let t=localStorage.getItem("token");D(e);let a={...W,[e]:{connected:!1}};try{(await fetch("/api/settings/integrations",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({integrations:JSON.stringify(a)})})).ok&&(J(a),I("Disconnected successfully.","success"))}catch(e){I("Network error.","error")}finally{D(null)}},[ex,em]=(0,s.useState)("Profile");if(e)return(0,a.jsx)("div",{className:"flex h-screen items-center justify-center bg-[#F3F4F6]",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(c.Loader2,{className:"w-10 h-10 animate-spin text-blue-600"}),(0,a.jsx)("p",{className:"text-gray-500 font-medium animate-pulse",children:"Loading settings..."})]})});let eh="Advanced"===X.plan||"Enterprise"===X.plan||"Trial"===X.plan;return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto pb-20 relative px-4 md:px-8",children:[y&&(0,a.jsx)(P,{message:y.message,type:y.type,onClose:()=>S(null)}),(0,a.jsx)(U,{isOpen:$,onClose:()=>L(!1),onSave:el}),(0,a.jsx)(A,{isOpen:F,onClose:()=>M(!1)}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Settings"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"Manage your account preferences and configurations."})]}),(0,a.jsxs)("button",{onClick:es,disabled:b,className:"flex items-center px-6 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 transition-all shadow-blue-200 disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none",children:[b?(0,a.jsx)(c.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}):(0,a.jsx)(r.Save,{className:"w-5 h-5 mr-2"}),"Save Changes"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden min-h-[600px] flex flex-col md:flex-row",children:[(0,a.jsx)("div",{className:"w-full md:w-64 bg-slate-50/50 border-b md:border-b-0 md:border-r border-slate-100 p-4 flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-visible",children:["Profile","Branding","AI","Voice Agent","Integrations","Security","Billing"].map(e=>(0,a.jsxs)("button",{onClick:()=>em(e),className:`flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-all whitespace-nowrap
                                ${ex===e?"bg-white text-blue-600 shadow-md shadow-blue-50 border border-blue-50":"text-slate-500 hover:bg-white hover:text-slate-700 hover:shadow-sm"}`,children:["Profile"===e&&(0,a.jsx)(x.User,{className:"w-4 h-4"}),"Branding"===e&&(0,a.jsx)(o,{className:"w-4 h-4"}),"AI"===e&&(0,a.jsx)(n.Bot,{className:"w-4 h-4"}),"Voice Agent"===e&&(0,a.jsx)(g.Phone,{className:"w-4 h-4"}),"Integrations"===e&&(0,a.jsx)(m,{className:"w-4 h-4"}),"Security"===e&&(0,a.jsx)(i.Shield,{className:"w-4 h-4"}),"Billing"===e&&(0,a.jsx)(N,{className:"w-4 h-4"}),e]},e))}),(0,a.jsxs)("div",{className:"flex-1 p-6 md:p-10 overflow-y-auto",children:["Profile"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Personal Profile"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Update your photo and personal details."})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 items-center md:items-start p-6 bg-slate-50/50 rounded-2xl border border-slate-100",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsxs)("div",{onClick:()=>Z.current?.click(),className:"relative w-32 h-32 rounded-full overflow-hidden border-4 border-white shadow-lg cursor-pointer group hover:border-blue-50 transition-all",children:[(0,a.jsx)("img",{src:K.avatarUrl?K.avatarUrl.startsWith("data:")||K.avatarUrl.startsWith("http")||K.avatarUrl.startsWith("/")?K.avatarUrl:`${t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:5000"}${K.avatarUrl}`:`https://ui-avatars.com/api/?name=${K.name||"User"}&background=0D8ABC&color=fff`,alt:"Avatar",className:"w-full h-full object-cover transition-transform group-hover:scale-110"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,a.jsx)(d,{className:"w-8 h-8 text-white drop-shadow-md"})}),Q&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-10",children:(0,a.jsx)(c.Loader2,{className:"w-8 h-8 animate-spin text-white"})})]}),(0,a.jsx)("input",{type:"file",ref:Z,onChange:en,className:"hidden",accept:"image/*"}),(0,a.jsx)("button",{onClick:()=>Z.current?.click(),className:"text-sm font-semibold text-blue-600 hover:text-blue-700",children:"Change Photo"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 w-full",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Full Name"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.User,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:K.name,onChange:e=>H({...K,name:e.target.value}),placeholder:"e.g. John Doe"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Mail,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"email",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:K.email,onChange:e=>H({...K,email:e.target.value}),placeholder:"e.g. john@example.com"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Phone Number"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Phone,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"tel",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:K.phoneNumber,onChange:e=>H({...K,phoneNumber:e.target.value}),placeholder:"+1 234 567 8900"})]})]})]})]})]}),"Branding"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Company Branding"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Customize the look and feel of your client portal."})]}),(0,a.jsxs)("div",{className:"p-6 bg-slate-50/50 rounded-2xl border border-slate-100 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Brand Color"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("input",{type:"color",className:"w-14 h-14 rounded-xl cursor-pointer border-none p-0 overflow-hidden shadow-sm",value:X.brandColor,onChange:e=>q({...X,brandColor:e.target.value})}),(0,a.jsx)("div",{className:"absolute inset-0 ring-1 ring-black/10 rounded-xl pointer-events-none"})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none font-mono text-sm uppercase",value:X.brandColor,onChange:e=>q({...X,brandColor:e.target.value})})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Logo URL"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none font-medium text-gray-900",placeholder:"https://example.com/logo.png",value:X.logoUrl,onChange:e=>q({...X,logoUrl:e.target.value})}),X.logoUrl&&(0,a.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 bg-white border border-gray-100 rounded-lg shadow-sm",children:(0,a.jsx)("img",{src:X.logoUrl,alt:"Preview",className:"h-6 w-6 object-contain",onError:e=>e.target.style.display="none"})})]})]})]})]}),"AI"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"AI Configuration"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Tailor your AI assistant's persona and instructions."})]}),(0,a.jsxs)("div",{className:"p-6 bg-slate-50/50 rounded-2xl border border-slate-100 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Assistant Name"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(n.Bot,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none font-medium text-gray-900",value:X.aiName,onChange:e=>q({...X,aiName:e.target.value}),placeholder:"e.g. BizBot 9000"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Custom System Prompt"}),!eh&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-1 rounded-full border border-amber-100",children:[(0,a.jsx)(h,{className:"w-3 h-3"})," Growth/Enterprise Feature"]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("textarea",{className:`w-full p-4 bg-white border border-gray-200 rounded-xl text-sm h-40 focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none resize-none leading-relaxed ${!eh?"blur-[2px] select-none pointer-events-none opacity-50":"text-gray-900"}`,placeholder:"Enter detailed instructions for your AI agent...",value:X.customSystemPrompt,onChange:e=>q({...X,customSystemPrompt:e.target.value})}),!eh&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("button",{className:"bg-white shadow-xl px-4 py-2 rounded-xl text-xs font-bold text-gray-800 flex items-center gap-2 border border-gray-100 hover:scale-105 transition-transform",children:"Upgrade to Edit"})})]})]})]})]}),"Voice Agent"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Voice Agent Configuration"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Connect your Twilio voice agent to handle inbound and outbound calls."})]}),(0,a.jsx)("div",{className:"p-6 bg-slate-50/50 rounded-2xl border border-slate-100 space-y-6",children:(0,a.jsx)(z,{showToast:I})})]}),"Integrations"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Integrations & Workflows"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Connect your tools and automate tasks."})]}),(0,a.jsxs)("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white text-xs font-bold rounded-lg hover:bg-black transition-colors shadow-lg shadow-gray-200",children:[(0,a.jsx)(w.Plus,{className:"w-3.5 h-3.5"})," New Workflow"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(T,{name:"Google Calendar",description:"Two-way sync for bookings.",connectedKey:"googleCalendar",integrations:W,onConnectClick:ei,onDisconnectClick:ed,loading:E,icon:j.Calendar}),(0,a.jsx)(T,{name:"Paystack Payments",description:"Accept payments in NGN & USD.",connectedKey:"paystack",integrations:W,onConnectClick:ei,onDisconnectClick:ed,loading:E,icon:N}),(0,a.jsx)(T,{name:"Mailchimp",description:"Sync client emails automatically.",connectedKey:"mailchimp",integrations:W,onConnectClick:ei,onDisconnectClick:ed,loading:E,icon:u.Mail})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-900 mb-4 border-b border-gray-100 pb-2",children:"Active Workflows"}),Array.isArray(R)&&0!==R.length?(0,a.jsx)("div",{className:"space-y-3",children:R.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-white border border-gray-200 rounded-xl flex items-center justify-between group hover:border-blue-200 hover:shadow-sm transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center text-blue-600",children:(0,a.jsx)(v.Zap,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-sm",children:e?.name||"Untitled"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 capitalize",children:[(e?.trigger||"").replace(/_/g," ")," â†’ ",(e?.action||"").replace(/_/g," ")]})]})]}),e?.id&&(0,a.jsx)("button",{onClick:()=>eo(e.id),className:"p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:(0,a.jsx)(k.Trash2,{className:"w-4 h-4"})})]},e?.id||Math.random()))}):(0,a.jsxs)("div",{className:"p-8 text-center bg-slate-50 border border-dashed border-slate-200 rounded-2xl",children:[(0,a.jsx)(p.Activity,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"No custom workflows yet."})]})]})]}),"Security"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Security Settings"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Manage password and access logs."})]}),(0,a.jsxs)("button",{onClick:()=>M(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 text-xs font-bold rounded-lg hover:bg-slate-200 transition-colors",children:[(0,a.jsx)(C.FileText,{className:"w-3.5 h-3.5"})," View Audit Logs"]})]}),(0,a.jsx)("div",{className:"p-6 bg-slate-50/50 rounded-2xl border border-slate-100 space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Current Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"password",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:G.currentPassword,onChange:e=>Y({...G,currentPassword:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"New Password"}),(0,a.jsx)("input",{type:"password",className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:G.newPassword,onChange:e=>Y({...G,newPassword:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all font-medium text-gray-900",value:G.confirmPassword,onChange:e=>Y({...G,confirmPassword:e.target.value})})]})]}),(0,a.jsx)("div",{className:"pt-2 flex justify-end",children:(0,a.jsx)("button",{onClick:er,disabled:!G.currentPassword||!G.newPassword,className:"px-6 py-2 bg-slate-800 text-white text-sm font-bold rounded-xl hover:bg-slate-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Update Password"})})]})})]}),"Billing"===ex&&(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Billing & Subscription"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Manage your plan and payment methods."})]}),(0,a.jsx)(B,{plan:X.plan,showToast:I})]})]})]})]})}e.s(["default",()=>I],68698)}]);